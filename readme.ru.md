# Обзор

Веб-приложение обрабатывает большие текстовые блоки, разбивая их на управляемые фрагменты и отправляя каждый из них в модель Google Gemini (Gemini Flash 1.5). Интерфейс позволяет вставлять текст вручную или загружать файлы с подсказками и содержимым, настраивать ограничение скорости запросов и получать итоговый ответ в одном объединённом файле.


# Пример использования

Подсказка:
```
This is the part of subtitles for the music man 1962 Movie. Please translate it to Russian Make sure that in the end you will get the correct subtitles In .srt format. Please do not format the result with the markdown leave only the subtitles as if they were in .srt file. Please leave the numbers of the subtitle entries and the times as is.

Example:
48
00:04:47,829 --> 00:04:48,871
What's the fella's line?
What's his line?

Result:
48
00:04:47,829 --> 00:04:48,871
��� ���� ������ ����������?
����� � ���� ���������?
```
Текст:

```
1
00:02:38,408 --> 00:02:40,451
All aboard!

2
00:02:49,252 --> 00:02:50,461
Let him go, Orville.

3
00:02:50,670 --> 00:02:55,258
We made it plain we don't want
no more traveling salesmen in Brighton.

...
```

Разделитель: `\n\n`
(двойное нажатие Enter)

Параллельные запросы: `15`

Максимум запросов в минуту: `15`

Размер фрагмента: `6500`

## Возможности

- Разделение больших текстов на управляемые фрагменты с помощью произвольных разделителей
- Параллельная обработка фрагментов моделью Google Gemini
- Ограничение скорости запросов (requests per minute)
- Сохранение отдельных ответов по каждому фрагменту в файлы
- Загрузка подсказок и исходного текста из локальных файлов
- Получение одного объединённого файла с итоговым ответом
- Веб-интерфейс с настройкой размера фрагмента и степени параллельности

## Предварительные требования

- Python 3.10 или новее
- API-ключ Google Cloud для доступа к Gemini
- Современный веб-браузер

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/give-in-chunks.git
cd give-in-chunks
```

2. Создайте и активируйте виртуальное окружение:
```bash
python -m venv venv
.\venv\Scripts\activate  # Windows
source venv/bin/activate  # Linux/Mac
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Создайте файл `.env` в корне проекта и добавьте свой API-ключ:
```bash
API_KEY=your_google_api_key_here
```

## Использование

1. Запустите Flask-сервер:
```bash
python main.py
```

2. Откройте в браузере страницу `http://localhost:5000`.

3. В веб-интерфейсе можно настроить или загрузить:
   - Подсказку для модели (вставить текст или выбрать файл)
   - Исходный текст (вставить текст или выбрать файл)
   - Разделитель для разбиения текста (по умолчанию `\n\n\n`)
   - Количество параллельных запросов (по умолчанию `5`)
   - Максимальное число запросов в минуту (опционально)
   - Размер фрагмента в символах (по умолчанию `8000`)

4. Нажмите **Generate**, чтобы запустить обработку. По завершении на странице появится результат и ссылка на скачивание объединённого файла.

## Настройки

- **Separator**: шаблон для разбиения текста на фрагменты (например, `\n\n` для абзацев)
- **Parallel Requests**: количество фрагментов, обрабатываемых одновременно
- **Max Requests per Minute**: ограничение скорости запросов к API (опционально)
- **Chunk Size**: максимальный размер фрагмента в символах

## Результат

- Обработанные ответы отображаются прямо в интерфейсе
- Доступен объединённый файл с результатом по ссылке для скачивания
- Отдельные ответы по каждому фрагменту сохраняются в директории `responses` с отметкой времени

## Обработка ошибок

- Ошибки при обработке фрагментов записываются в отдельные файлы в `responses`
- Сообщения об ошибках выводятся в веб-интерфейсе
- При включённом ограничении скорости количество параллельных запросов автоматически подстраивается

## Структура проекта

- `main.py`: веб-приложение Flask и обработчики маршрутов
- `generate.py`: логика разбиения текста и взаимодействия с моделью
- `requirements.txt`: зависимости Python
- `.env`: конфигурация с API-ключами (не хранится в репозитории)
- `responses/`: директория для сохранения результатов обработки

## Вклад в проект

1. Сделайте форк репозитория
2. Создайте ветку (`git checkout -b feature/my-feature`)
3. Зафиксируйте изменения (`git commit -m 'Add my feature'`)
4. Отправьте ветку (`git push origin feature/my-feature`)
5. Создайте Pull Request

Пожалуйста, убедитесь, что:
- README обновлён при необходимости
- `requirements.txt` дополнен новыми зависимостями, если они появились
- Соблюдён текущий стиль кода
- При необходимости добавлены комментарии
- Изменения протестированы

## Лицензия

Проект распространяется по лицензии Apache License 2.0. Подробнее см. файл [LICENSE](LICENSE).

Лицензия Apache 2.0 разрешает свободно использовать программное обеспечение при условии указания авторства и сохранения той же лицензии для производных работ.
